---
title: "What Makes the Best Coffee?"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

# Not your average joe

![](images/home_picture.png)

### Website Overview

There are two datasets in our project analysis. One is from the [Coffee Quality Institute](https://database.coffeeinstitute.org/) to rate coffee based on their acidity, sweetness, aroma, altitude, and region, offering an objective ratings about coffee. The other one is from the ["Great American Coffee Taste Test"](https://www.youtube.com/watch?v=bMOOQfeloH0), which examines consumer preferences. 

In the Exploratory Analysis tab, you will find:

 * The [trends and distributions](data_exploration_ratings.html)of objective coffee ratings by year, species, varieties, processing methods, altitude, and country of origins
 
 * The [coffee-related lifestyle topics](data_exploration_survey.html), such as brewing methods, reasons for drinking coffee, daily consumption habits, favorite coffee types, spending patterns, caffeine knowledge, and pricing preferences
 
In the Statistical Analysis tab, you will find:

 * The statistical analysis for the [objective coffee ratings](analysis_ratings.html) about what factors truly affecting the coffee scores and whether coffee processing methods make a big difference in ratings
 
 * The statistical analysis for the [coffee-related lifestyle topics](analysis_survey.html), showing interesting demographic facts about coffee consumers and there preferences between two different coffee
 

The [Shiny tab](shiny.html) will help you explore and identify your preferred coffee processing methods.

The [Report tab](report.html) provides a comprehensive overview of our analytical procedure, outlining each step in detail, and also a discussion about our findings combining the two datasets together.

### Coffee World Map

```{r, include=FALSE}
library(plotly)
library(dplyr)
library(countrycode)
library(readr)
library(stringr)
```

```{r, message=FALSE}
ratings_df = read_csv("data/coffee_ratings.csv") %>%
  janitor::clean_names() %>%
  select(total_cup_points, species, country_of_origin, 
         region, grading_date, variety,processing_method, 
         aroma, flavor, aftertaste, acidity, body, balance,
         sweetness, moisture, color, altitude_low_meters, 
         altitude_high_meters, altitude_mean_meters,) %>%
  mutate(grading_year = str_extract(grading_date, "\\d{4}"),
         species = as.factor(species),
         variety = as.factor(variety),
         processing_method = as.factor(processing_method),
         moisture = as.factor(moisture),
         color = as.factor(color))
```

```{r, fig.width=6, fig.asp=.6, out.width="90%"}
coffee_counts = ratings_df |>
  mutate(
    country_of_origin = tolower(country_of_origin),
    country_of_origin = case_when(
      country_of_origin %in% c("united states", "united states (hawaii)", "united states (puerto rico)") ~ "united states",
      TRUE ~ country_of_origin)
  ) |>
  group_by(country_of_origin) |>
  summarise(count = n()) |>
  ungroup() |>
  mutate(iso3 = countrycode(country_of_origin, "country.name", "iso3c"))

plot_ly(
  data = coffee_counts,
  type = "choropleth",
  locations = ~iso3, 
  z = ~count, 
  colorscale = "RdYlGn",  
  text = ~country_of_origin, 
  colorbar = list(
    title = "# of Coffee Varieties",
    thickness = 10)
) %>%
  layout(
    title = "Coffee-Producing Countries",
    geo = list(
      projection = list(type = "natural earth")
    )
  )
```

### Screencast

Click on the video below for a brief walk through of the website.

### Team Members

* Jinghan Zhao - jz3902
* Leyang Rui - lr3257
* Yifei Yu - yy3563
* Yuechu Hu - yh3822

