---
title: "Data Exploration"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide

---
```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(modelr)
library(haven)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%",
  warning = FALSE,
  message = FALSE
)

ratings_df = read_csv("data/coffee_ratings.csv") %>% 
  janitor::clean_names() %>%
  select(total_cup_points, species, country_of_origin, 
         region, number_of_bags, bag_weight, grading_date, variety,
         processing_method, aroma, flavor, aftertaste, acidity, body, balance,
         uniformity, clean_cup, sweetness, cupper_points, moisture, color,
         altitude_low_meters, altitude_high_meters, altitude_mean_meters) %>%
  mutate(grading_year = str_extract(grading_date, "\\d{4}"),
         species = as.factor(species),
         variety = as.factor(variety),
         processing_method = as.factor(processing_method),
         moisture = as.factor(moisture),
         color = as.factor(color))


```

### The Origins of Top Coffees Each Year from 2010 to 2018

```{r}
top_origins = 
  ratings_df |> 
  group_by(grading_year) |> 
  arrange(grading_year, desc(total_cup_points)) |> 
  slice(1)

top_origins |> 
  arrange(grading_year) |> 
  select(grading_year, country_of_origin, total_cup_points) |> 
  knitr::kable(
    col.names = c("Year", "Country of Origin", "Total Cup Points"),
    caption = "Top Coffee by Country from 2010 to 2018",
  )
```

The diversity of countries shows that competition in the coffee industry is global, with no single country dominating year after year.

Brazil has been on the list twice (2011 and 2013), indicating that it has consistently produced highly rated coffee during this period.

Ethiopia showed pretty good coffee strength with a top score of 90.58 in 2015, which is the highest coffee rating in those eight years.

